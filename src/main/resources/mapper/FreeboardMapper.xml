<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.bitcamp.mapper.FreeboardMapper">
	<resultMap type="com.bitcamp.DTO.freeboard.FreeboardDTO"
		id="freeboardMap">
		<result property="freeboard_no" column="freeboard_no"></result>
		<result property="freeboard_title" column="freeboard_title"></result>
		<result property="freeboard_content" column="freeboard_content"></result>
		<result property="freeboard_regiTime"
			column="freeboard_regitime"></result>
		<result property="freeboard_hits" column="freeboard_hits"></result>
		<result property="freeboard_status" column="freeboard_status"></result>
		<result property="freeboard_category"
			column="freeboard_category"></result>
		<result property="member_no" column="member_no"></result>
		<result property="user_nick" column="user_nick" />
	</resultMap>

	<insert id="insertData"
		parameterType="com.bitcamp.DTO.freeboard.FreeboardDTO">
		insert into freeboard
		values(freeboard_seq.nextval,
		#{freeboard_title},
		#{freeboard_content}, sysdate, 0, 1,
		#{freeboard_category},
		#{member_no})
	</insert>

	<select id="getList" resultMap="freeboardMap">
		select freeboard_no, freeboard_title,
		freeboard_content,
		freeboard_regitime, freeboard_hits,
		freeboard_member_no, user_nick from
		freeboard
		LEFT OUTER JOIN member on freeboard.freeboard_member_no =
		member.member_no
		where freeboard_status =1
		<if test='_parameter!="전체"'> and freeboard_category=#{_parameter} </if>

		order by freeboard_no desc
	</select>

	<select id="getDetail" resultMap="freeboardMap"
		parameterType="int">
		select *
		from freeboard
		where freeboard_no =
		#{freeboard_no}
	</select>

	<update id="modifyData"
		parameterType="com.bitcamp.DTO.freeboard.FreeboardDTO">
		update freeboard set
		freeboard_category =
		#{freeboard_category},
		freeboard_title=#{freeboard_title},
		freeboard_content =
		#{freeboard_content}
		where freeboard_no =
		#{freeboard_no}
	</update>

	<update id="deleteData" parameterType="Int">
		update freeboard
		set
		freeboard_status = 0
		where freeboard_no = #{freeboard_no}
	</update>

	<select id="getSearchList" resultMap="freeboardMap"
		parameterType="map">
		select freeboard_no, freeboard_title,
		freeboard_content,
		freeboard_regitime, freeboard_hits,
		freeboard_member_no, user_nick from
		freeboard
		LEFT OUTER JOIN member on freeboard.freeboard_member_no =
		member.member_no
		<trim prefix="WHERE" prefixOverrides="AND|OR">
			<if test="searchType=='제목'">
				and freeboard_title like '%'||#{searchKeyword}||'%'
			</if>
			<if test="searchType=='닉네임'">
				and user_nick like '%'||#{searchKeyword}||'%'
			</if>
		</trim>
		order by freeboard_no desc
	</select>

	<update id="updateHits" parameterType="int">
		update freeboard
		set
		freeboard_hits = freeboard_hits+1
		where freeboard_no = #{freeboard_no}
	</update>

</mapper>